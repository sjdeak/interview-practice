For the 0st consulate, it is last visited by guests 0 and 1 (at the end of the 1st minute).


whose final position is on or just after it in a clockwise order can be the last visiting group. 
take the difference of their final positions and the position of the consulate and subtract this number from M.